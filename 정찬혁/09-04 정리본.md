# 09-04

< 09-03과 조금 겹치는 부분이 있을 수 있습니다. >

## 바이트 단위 입출력 **★★★**

### **입력 스트림( InputStream ) 계열**

| 클래스 | 용도 |
| --- | --- |
| FileInputStream | 파일에서 바이트 단위로 읽기 |
| ByteArrayInputStream | 바이트 배열에서 읽기 |
| BufferedInputStream | 버퍼를 이용한 효율적인 읽기 |
| DataInputStream | 기본 데이터 타입 읽기 |

### **출력 스트림(** Output Stream**) 계열**

| 클래스 | 용도 |
| --- | --- |
| FileOutputStream | 파일에 바이트 단위로 쓰기 |
| ByteArrayOutputStream | 바이트 배열에 쓰기 |
| BufferedOutputStream | 버퍼를 이용한 효율적인 쓰기 |
| DataOutputStream | 기본 데이터 타입 쓰기 |

## 문자 단위 입출력 (Reader/Writer) **★★★**

### Reader 계열

| 클래스 | 용도 |
| --- | --- |
| FileReader | 파일에서 문자 단위로 읽기 |
| StringReader | 문자열에서 읽기 |
| BufferedReader | 버퍼를 이용한 효율적인 읽기 (readLine() 제공) |
| InputStreamReader | 바이트 스트림을 문자 스트림으로 변환 |
| Printwriter | println(), print(), printf() 같은 메소드를 쓸 수 있음 |

### Writer 계열

| 클래스 | 용도 |
| --- | --- |
| FileWriter | 파일에 문자 단위로 쓰기 |
| StringWriter | 문자열로 쓰기 |
| BufferedWriter | 버퍼를 이용한 효율적인 쓰기 |
| OutputStreamWriter | 문자 스트림을 바이트 스트림으로 변환 |

Buffer → 데이터를 일시적으로 담아두는 공간 ( 메모리 안에 있는 임시 저장소 )

### 문자 스트림 예제 코드

```java
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;

public class CharStreamExample {
    public static void main(String[] args) {
        try (FileReader reader = new FileReader("input.txt");
             FileWriter writer = new FileWriter("output.txt")) {

            int character;
            // 파일 끝(-1)까지 한 문자씩 읽기
            while ((character = reader.read()) != -1) {
                writer.write(character);
            }
            System.out.println("텍스트 파일 복사 완료!");

        } catch (IOException e) {
            System.err.println("파일 처리 중 오류: " + e.getMessage());
        }
    }
}
```

### File  클래스 활용 예제 코드

```java
package day12;

import java.io.File;
import java.io.IOException;

public class FileInfo {
    public static void main(String[] args) {
        File f = new File("src/day12/output.txt");
        if(f.exists()) { // 파일이 존재할 경우
            System.out.println("length : " + f.length());   //파일 크기(바이트 단위) 출력
            System.out.println("canRead : " + f.canRead()); //파일을 읽을 수 있는지 여부 출력
            System.out.println("canWrite : " + f.canWrite());   // 파일에 쓸 수 있는지 여부 출력
            System.out.println("getAbsolutePath : " + f.getAbsolutePath()); //파일의 절대 경로 출력
            try {
                System.out.println("getCanonicalPath : " + f.getCanonicalPath());   //파일의 정규화된 경로 출력
            } catch(IOException e) {
                System.out.println(e);  //경로 변환 중 오류 발생 시 출력
            }
            System.out.println("getName : " + f.getName()); //파일 이름만 출력
            System.out.println("getParent : " + f.getParent());     //파일의 상위 디렉토리 경로 출력
            System.out.println("getPath : " + f.getPath()); //파일 생성시 지정한 경로 그대로 출력
        } else { // 파일이 존재하지 않을 경우
            System.out.println("파일이 존재하지 않습니다.");
        }
    }
}
/*
*length : 1172
*canRead : true
*canWrite : true
*getAbsolutePath : C:\all\Likelion\HappyJava\src\day12\output.txt
*getCanonicalPath : C:\all\Likelion\HappyJava\src\day12\output.txt
*getName : output.txt
*getParent : src\day12
*getPath : src\day12\output.txt
*/
```

- java.io.File 클래스는 파일의 크기, 파일의 접근 권한, 파일의 삭제, 이름 변경 등의 작업을 할 수 있는 기능을 제공해 준다.

```java
package day12;

import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;

public class ReadFile2 {
    public static void main(String[] args) throws Exception {
  
        FileInputStream fis = null;
        FileOutputStream fos = null;

        try {
	          fis = new FileInputStream("src/day12/IOExam1.java"); //읽을 준비
            fos = new FileOutputStream("src/day12/IOExam2.java"); // 쓸 준비
            int n = 0;
            int count = 0;
            byte[] bytes = new byte[1024]; //한 번 읽을 때 1024바이트만큼 읽을게
            while ((n = fis.read(bytes)) != -1){
                String str = new String(bytes, 0, n); //0~ n-1까지만 즉 실제로 읽은 부분만 변환
                System.out.println(str);
                count++;
            }
            System.out.println(count);
        }catch (IOException e){
            System.out.println(e.getMessage());
        }catch (Exception ex){
            System.out.println(ex.getMessage());
        }finally {
            if(fis != null){
                try {
                    fis.close();    //
                }catch (IOException e){
                    System.out.println(e.getMessage());
                }
            }
            if(fos != null){
                try {
                    fos.close();
                }catch (IOException e){
                    System.out.println(e.getMessage());
                }
            }
        }
    }
}

```

- byte[] bytes = new byte[1024];
    - 한 번 읽을 때 1024바이트만큼 읽을게
    - 만약 파일이 2000바이트라면 while문이 2번 돌게 되고 count는 2가 된다.
- String str = new String(bytes, 0, n);
    - 0~ n-1까지만 즉, 실제로 읽은 부분만 변환
    - bytes를 String으로
- 예외 처리를 하게 된다면 finally에 넣어서 close() 해주는 게 좋다.

### try-with-resources 방식

- 매번 try-chat로 close() 하기 힘듦, try-with-resources 방식을 사용
    - 자동으로 리소스를 닫아준다 (close() 자동 호출
- 코드가 간결해진다.
- 리소스 누수를 방지
- finally 블록이 필요 없다.

### try-with-resources 예제 코드

```java
package day12;

import java.io.*;

public class IOExam2 {
    // 사용자의 정보(이름, 전화번호, 주소)를 입력받아서 파일에 저장하는 메서드
    public static void userInfoInput(String path) {
        try (
				        //try-with-resources 방식
                BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
                PrintWriter writer = new PrintWriter(new FileWriter(path));
               //PrintWriter --> println(), print(), printf() 같은 메소드를 쓸 수 있음
        ) {
            System.out.print("이름: ");
            String name = reader.readLine();

            System.out.print("전화번호: ");
            String number = reader.readLine();

            System.out.print("주소: ");
            String address = reader.readLine();
						
						//파일에 입력받은 값을 저장
            writer.println("이름: " + name);
            writer.println("전화번호: " + number);
            writer.println("주소: " + address);

            System.out.println("사용자의 파일이 생성되었습니다.");
            System.out.println("================================");

        } catch (IOException e) {
            System.err.println("입력 오류: " + e.getMessage());
        }
    }

    // 파일로부터 읽어와서 사용자의 정보를 출력하는 메서드
    public static void userInfoOutput(String path) {
        try (BufferedReader reader = new BufferedReader(new FileReader(path))) {
            System.out.println("사용자의 정보를 출력 합니다.");

            String line;

            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            System.out.println("출력 오류: " + e.getMessage());
        }
    }

    public static void main(String[] args) {
        String path = "src/day12/userInfo.txt";
        userInfoInput(path);
        userInfoOutput(path);
    }
    //실행시 src/day12/userInfo.txt 위치에 userInfo.txt가 생성되고 사용자로부터 입력받은 값을 저장
}
```

- BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
    - System.in은 사용자로부터 바이트 단위 입력을 받게 된다
    - InputStreamReader에서 바이트를 문자로 변환
    - BufferedReader → 문자 단위 입력을 **버퍼에 모아뒀다가 한 줄 단위로 읽을 수 있게 해줌,**  readLine() 메소드 사용 가능 (즉, 효율적으로 읽을 수 있음)
    - Buffer → 데이터를 일시적으로 담아두는 공간 ( 메모리 안에 있는 임시 저장소 )
- while ((line = reader.readLine()) != null)
    - 파일의 끝에 도달하면 null 반환