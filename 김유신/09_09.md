# 09/09 회고록
<br>

## 데이터베이스 개요

- 정의: 데이터베이스는 여러 응용 시스템이 공유하는 조직화된 데이터의 집합. 저장·검색·갱신을 효율적으로 수행.
- 특성
    - 실시간 접근성: 요청 시 즉시 처리
    - 계속적 변화: 삽입/삭제/수정으로 지속 갱신
    - 동시 공유성: 여러 사용자가 동시에 접근
    - 내용 참조: 위치가 아닌 내용(값) 기반 참조

- 구조(테이블 중심):
    - 테이블(Table) = 저장 단위
    - 행(Row/Record) = 한 개체의 데이터
    - 열(Column/Field) = 속성
    - 키(Key) = 행을 고유 식별(예: 기본키 PK)

### 관계형 데이터베이스(RDB)와 MySQL
- RDB 데이터를 정형 테이블로 저장, 관계(Relationship)로 연결, SQL로 조작, 무결성과 일관성 보장.
- SQL 종류 
    - DDL(정의): CREATE / ALTER / DROP

    - DML(조작): SELECT / INSERT / UPDATE / DELETE

    - DCL(권한): GRANT / REVOKE

    - TCL(트랜잭션): COMMIT / ROLLBACK / SAVEPOINT

- MySQL: 대표 오픈소스 RDBMS, 웹 개발에 널리 사용(LAMP).


## Docker 기반 MySQL 실행 및 관리 

### Docker 기본 개념

#### Docker란?
- **컨테이너(Container)** 기반 가상화 플랫폼
- 가상머신(VM)과 달리 OS 전체를 가상화하지 않고, 필요한 프로세스만 격리 실행
- 빠른 시작, 낮은 자원 소모, 일관된 실행 환경 제공

#### 핵심 용어
- **이미지(Image)**  
  애플리케이션 실행에 필요한 환경(파일시스템, 라이브러리, 설정 등)을 스냅샷으로 만든 것
  → 예: `mysql:8.0`  
- **컨테이너(Container)**  
  이미지를 실제로 실행한 인스턴스. 독립된 프로세스처럼 동작.  
- **Docker Hub**  
  전 세계 개발자들이 공유하는 공개 이미지 저장소. (`docker pull` 로 가져옴)  
- **볼륨(Volume)**  
  컨테이너와 독립적으로 데이터를 보존하는 저장 공간. 컨테이너 삭제 후에도 데이터 유지 가능

#### 왜 Docker를 쓰는가?
- 설치/삭제 간편 (한 줄 명령으로 설치 & 제거 가능)
- 환경 격리 (서로 다른 버전이 동시에 공존 가능)
- 버전 충돌 방지
- 재현성 상승 (개발 → 테스트 → 운영 환경 동일 보장)
- 배포 자동화 및 CI/CD 친화적

---

### MySQL 컨테이너 실행

#### 빠른 실행 예시
```bash
docker run -d \
  --name mysql8 \
  -p 3306:3306 \
  -e MYSQL_ROOT_PASSWORD=1234 \
  mysql:8.0

  -d : 백그라운드 실행

--name : 컨테이너 이름 지정

-p 3306:3306 : 호스트 포트 ↔ 컨테이너 포트 매핑

-e MYSQL_ROOT_PASSWORD=1234 : 루트 비밀번호 설정

mysql:8.0 : 사용할 이미지
```



## Docker 네트워크 구조

### 기본 네트워크
- **bridge**  
  기본 네트워크 모드. 컨테이너는 내부 IP를 할당받아 통신 
- **host**  
  호스트 네트워크를 그대로 사용 포트가 겹칠 수 있음  
- **none**  
  네트워크가 완전히 없는 상태로, 외부와 통신할 수 없음

### 호스트와 컨테이너 통신
- **호스트 → 컨테이너**  
  포트 매핑(`-p`)을 통해 접근 
  예: `localhost:3306` → 컨테이너의 MySQL 3306 포트  
- **컨테이너 → 컨테이너**  
  동일 네트워크에 속한 경우 컨테이너명(서비스명)을 호스트네임처럼 사용 
  예: `mysql:3306`

### IPAddress vs Gateway
- **IPAddress**  
  컨테이너 자체의 내부 IP. 다른 컨테이너에서 접근할 때 사용  
- **Gateway**  
  브리지 네트워크에서 호스트가 가지는 주소. 컨테이너에서 바라본 호스트의 IP

---

### MySQL 접속 방식 (localhost vs 127.0.0.1)

- `localhost` → 유닉스 소켓 파일(IPC)로 접속  
- `127.0.0.1` → TCP/IP로 접속 
- mysql상 `localhost`와 `127.0.0.1`는 다른 주소로 취급 
    - `'carami'@'localhost'` 를 mysql workbench로 접속시 hostname을 127.0.0.1로 설정하면 접근 불가. 반드시 localhost로 넣어줘야함.


#### Docker 환경
- 호스트에서 컨테이너의 MySQL에 접속할 때는 `localhost:3306` 또는 `127.0.0.1:3306`을 사용

---

### MySQL 사용자 및 권한 관리

#### 계정 규칙
- `'user'@'host'` 조합이 고유한 계정
- `'carami'@'localhost'`와 `'carami'@'%'`는 서로 다른 계정으로 취급

#### 계정 생성
```sql
-- 모든 호스트에서 접속 가능
CREATE USER 'carami'@'%' IDENTIFIED BY 'kang1234';

-- 로컬 전용
CREATE USER 'carami'@'localhost' IDENTIFIED BY 'kang1234';

-- 권한 부여
GRANT ALL PRIVILEGES ON liondb.* TO 'carami'@'%';

-- 권한 확인
SHOW GRANTS FOR 'carami'@'%';

-- 권한 취소
REVOKE INSERT, UPDATE ON liondb.* FROM 'carami'@'%';

-- 계정 삭제
DROP USER 'carami'@'%';
```
- GRANT, CREATE USER, REVOKE, DROP USER는 즉시 반영된다.
- 직접 mysql.user 테이블을 수정한 경우에는 FLUSH PRIVILEGES;를 실행해야함