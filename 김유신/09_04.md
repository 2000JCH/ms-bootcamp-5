# 09_04 회고록

### 바이트 단위 입출력
- 모든 데이터를 표현할 수 있는 가장 기본적인 스트림
- 1바이트씩 처리
- 이진 데이터(이미지, 오디오, 영상 등)를 처리하는 데 적합

### 주요 클래스/메소드
- 주인공 클래스: InputStream, OutputStream
- 데코레이트 : XXXInputStream, XXXOutputStream

- InputStream 관련 메소드
    - int read() : 1바이트씩 읽고 반환, EOF는 -1
    - int read(byte[] b), int read(byte[] b, int off, int len) : 버퍼로 다중 바이트 읽기
    - int available() : 블로킹 없이 읽을 수 있는 바이트 수

- OutputStream 관련 메소드
    - void write(int b) : 1바이트 쓰기
    - void write(byte[] b), void write(byte[] b, int off, int len) : 버퍼로 다중 바이트 쓰기
    - void flush() : 내부 버퍼 강제 비우기

### 문자 단위 입출력
- 텍스트 처리에 최적화된 스트림
- 문자셋(Encoding)을 자동으로 처리해 유니코드 기반 다국어 지원 가능


### 주요 클래스/메소드

- 주인공 클래스: Reader, Writer
- 브리지: InputStreamReader(바이트→문자), OutputStreamWriter(문자→바이트)
- 버퍼링: BufferedReader(readLine 제공), BufferedWriter(newLine 제공)

### FileWriter
- 파일에 문자 단위로 데이터를 쓰는 클래스
- 상속 계층: Writer → OutputStreamWriter → FileWriter
- 플랫폼의 기본 문자 인코딩을 사용 (예: Windows = MS949, Linux/Mac = UTF-8)
- 인코딩을 명시적으로 지정할 수 없음 → 이 때문에 국제화/다국어 환경에서는 잘 쓰이지 않음
- 파일 쓰기 전용 → 콘솔 출력은 불가


### PrintWriter
- 다양한 타입을 텍스트로 포맷팅해서 출력할 수 있는 고수준 Writer
- 상속 계층: Writer → PrintWriter
- 문자열뿐 아니라 int, double, boolean, 객체(toString) 등을 쉽게 출력 가능
- print, println, printf, format 제공
    - System.out은 PrintStream 타입의 static필드로, JVM이 실행될 때 운영체제의 표준 출력(콘솔)에 연결된 스트림
    - 그래서 System.out과 PrintWriter는 유사한 문법을 가짐
- 자동 flush 설정 가능 (new PrintWriter(writer, true))
- 출력 대상 다양함
    - 파일(FileWriter), 네트워크 소켓(OutputStream), StringWriter 등 다양한 Writer/Stream을 감쌀 수 있음


### 표준 입출력 (System.in / System.out / System.err)

- 타입: System.in = InputStream, System.out/System.err = PrintStream.

- System.in: 콘솔/파이프 입력 → 보통 InputStreamReader+BufferedReader 또는 Scanner로 래핑
- System.out: 일반 콘솔 출력, print/println/printf
- System.err: 오류/경고 전용(로그 분리/리다이렉션)


### 파일 입출력
- 파일 입출력은 데이터의 영속성을 보장하는 핵심 기능으로 File클래스를 통해 외부 파일을 다룸
- File 클래스는 파일/디렉터리 조작, 메타데이터, 생성/삭제/복사/이동 등을 처리

#### 파일 입출력 과정
- 파일 읽기 과정
    - 파일과의 연결 생성 (FileInputStream/FileReader)
    - 데이터 읽기 (read() 메소드)
    - 리소스 해제 (close() 메소드)
- 파일 쓰기 과정
    - 파일과의 연결 생성 (FileOutputStream/FileWriter)
    - 데이터 쓰기 (write() 메소드)
    - 리소스 해제 (close() 메소드)


```java
package day12;

import java.io.*;
import java.util.ArrayList;
import java.util.Scanner;

public class IOExam2 {
    public static void main(String[] args) {
        ArrayList<Person> person = new ArrayList<>();

        // ---- [읽기] 파일 → 컬렉션 ----
        readUserFromFile(person, "HappyJava/user.txt");

        for (Person p : person) System.out.println(p);
    }

    // ---- [쓰기] 콘솔 입력 → 파일(FileWriter) ----
    public static void saveUser() {
        // [1] 파일과의 연결 생성 (문자 스트림)
        try (Scanner kb = new Scanner(System.in);
             FileWriter fw = new FileWriter("HappyJava/user.txt")) { // [3] close 자동
            // [2] 데이터 쓰기 (write)
            System.out.print("이름 : ");
            String name = kb.nextLine();
            System.out.print("전화번호 : ");
            String phone = kb.nextLine();
            System.out.print("주소 : ");
            String location = kb.nextLine();

            fw.write("\n이름 : " + name + "\n전화번호 : " + phone + "\n주소 : " + location);
            // [3] 리소스 해제: try-with-resources 블록 종료 시 자동 flush/close
        } catch (IOException e) {
            System.out.println(e.getMessage());
        }
    }

    // ---- [읽기] 파일 → 콘솔(그대로 출력) ----
    public static void printUserByFile() {
        // [1] 파일과의 연결 생성 + 버퍼링(라인 읽기)
        try (BufferedReader br = new BufferedReader(new FileReader("HappyJava/user.txt"))) { // [3] close 자동
            // [2] 데이터 읽기 (readLine)
            String n;
            while ((n = br.readLine()) != null) {
                System.out.println(n);
            }
            // [3] 리소스 해제: 자동
        } catch (IOException e) {
            System.out.println(e.getMessage());
        }
    }

    // ---- [쓰기] 콘솔 입력 → 컬렉션 → 파일(PrintWriter) ----
    public static void saveUserFromCollection(ArrayList<Person> person) {
        // [수집] 콘솔에서 5명 입력 받아 메모리(ArrayList)에 저장
        try (Scanner kb = new Scanner(System.in);
             // [1] 파일과의 연결 생성 (PrintWriter: println/printf 등 편의)
             PrintWriter fw = new PrintWriter("HappyJava/user.txt")) { // [3] close 자동
            for (int i = 0; i < 5; i++) {
                System.out.print("이름 : ");
                String name = kb.nextLine();
                System.out.print("전화번호 : ");
                String phone = kb.nextLine();
                System.out.print("주소 : ");
                String location = kb.nextLine();
                person.add(new Person(name, phone, location));
            }
            // [2] 데이터 쓰기 (write/println)
            for (Person p : person) fw.write(p.toString());
            // [3] 리소스 해제: 자동 (PrintWriter는 close 시 flush 포함)
        } catch (IOException e) {
            System.out.println(e.getMessage());
        }
    }

    // ---- [읽기] 파일 → 컬렉션(ArrayList<Person>) ----
    public static void readUserFromFile(ArrayList<Person> person, String fileName) {
        // [1] 파일과의 연결 생성 + 버퍼링
        try (BufferedReader br = new BufferedReader(new FileReader(fileName))) { // [3] close 자동
            // [2] 데이터 읽기(라인) + 간단 파싱(split)
            String n;
            while ((n = br.readLine()) != null) {
                // 형식 가정: "이름 전화번호 주소..."  (split(" ", 3) → 앞 2개 + 나머지 전체)
                String[] s = n.split(" ", 3);
                if (s.length < 2) continue; // 최소 방어
                String name = s[0];
                String phone = s[1];

                StringBuilder location = new StringBuilder();
                for (int i = 2; i < s.length; i++) location.append(s[i]).append(' ');

                person.add(new Person(name, phone, location.toString().trim()));
            }
            // [3] 리소스 해제: 자동
        } catch (IOException e) {
            System.out.println(e.getMessage());
        }
    }
}

class Person {
    String name;
    String phone;
    String location;

    public Person(String name, String phone, String location) {
        this.name = name;
        this.phone = phone;
        this.location = location;
    }

    @Override
    public String toString() {
        return "이름 : " + name + "\n" +
               "전화번호 : " + phone + "\n" +
               "주소 : " + location + "\n";
    }
}
```
### 보조 스트림
- Buffered: 성능 향상 (BufferedInputStream/BufferedOutputStream, BufferedReader/Writer)
- Data: 기본형/문자열 포맷 (DataInputStream/DataOutputStream → readInt/writeInt, readUTF/writeUTF)
- Object: 직렬화 (ObjectInputStream/ObjectOutputStream → readObject/writeObject)
- Print: 편리한 포맷 출력 (PrintStream/PrintWriter)
